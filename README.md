# 訂正依頼システム (App_request)

学校における出欠訂正・評価評定変更の依頼を管理するデスクトップアプリケーション

## 概要

**バージョン**: 1.5.0  
**開発言語**: Python 3.11  
**フレームワーク**: PySide6 (Qt for Python)  
**データベース**: SQLite

## 主な機能

### 📝 訂正入力
- 出欠訂正と評価評定変更の依頼を登録
- ロック有無フィルター（全て/ロック済み/未ロック）
- **NEW!** 生徒名検索（ひらがな対応）
- **NEW!** 講座名検索
- **NEW!** 日時・学期の表示改善
- 「表示」ボタンで詳細表示（ロック済みも表示可能）
- 編集ウィンドウでロック済みは編集不可
- 訂正入力のCSVエクスポート機能
- 複数の訂正依頼を一括入力
- **NEW!** 確認ダイアログに生徒名・講座名表示
- 色分けUI（出欠:薄緑、評価:薄オレンジ）

### 📢 お知らせ
- お知らせタブ
- システムからの重要なお知らせを表示
- デフォルトメッセージ対応

### 🔧 システム部管理
- パスワード保護された管理画面（初期: admin123）
- 訂正依頼管理タブ
  - 詳細13項目表示
  - 訂正依頼のロック/ロック解除
  - CSVエクスポート/インポート
  - **NEW!** 操作ログに削除データの詳細記録
- 生徒情報管理タブ
  - CSV入出力
  - **NEW!** ID自動生成（年度-組番号）
- 講座情報管理タブ
  - CSV入出力
  - **NEW!** ID自動生成（年度-講座番号）
- 操作ログタブ
  - ログ閲覧、CSVエクスポート
- 設定タブ
  - パスワード変更
  - アプリタイトル変更
  - お知らせ内容編集
  - **NEW!** バックアップ間隔設定
  - **NEW!** 手動バックアップ機能

### 💾 バックアップ機能
- **NEW!** 定期自動バックアップ（起動回数ベース）
- **NEW!** バックアップ間隔の設定変更（1〜100回）
- **NEW!** 手動バックアップ機能
- **NEW!** 古いバックアップの自動削除（最新10件保持）
- バックアップファイル: `data/backups/corrections_backup_YYYYMMDD_HHMMSS.db`

## システム要件

- **OS**: Windows 10/11, macOS 10.15+
- **Python**: 3.11以上
- **必要なパッケージ**: requirements.txt 参照

## インストール

### 開発環境

```bash
# リポジトリをクローン
git clone https://github.com/seyaytua/request.git
cd request

# 仮想環境を作成
python3.11 -m venv venv

# 仮想環境を有効化
# macOS/Linux:
source venv/bin/activate
# Windows:
venv\Scripts\activate

# 依存パッケージをインストール
pip install -r requirements.txt

# データベース初期化
python -c 'from src.database.init_db import initialize_database; from src.config import DB_PATH; initialize_database(DB_PATH, force=True)'
実行
Copypython main.py
実行ファイル化（Windows用）
Copypyinstaller --onefile --windowed --name="訂正依頼システム" main.py
使い方
訂正依頼の登録
「訂正入力」タブを開く
右側の入力フォームに情報を入力
「確認して登録」ボタンをクリック
確認ダイアログで内容を確認（生徒名・講座名が表示されます）
「登録」をクリックして完了
訂正依頼の検索
検索ボックスに入力
生徒名で検索（例：「山田」）
ひらがなで検索（例：「やまだ」）
講座名で検索（例：「数学」「英語」）
訂正依頼の表示・編集
リストから表示したい依頼を選択
「👁️ 表示」ボタンをクリック
詳細が表示される
ロックされていない場合は「編集」ボタンで編集可能
お知らせの確認
「📢 お知らせ」タブをクリック
システムからのお知らせを確認
システム部管理
「🔧 システム部管理」タブをクリック
パスワードを入力（初期: admin123）
認証成功後、管理画面が表示されます
設定タブで各種設定が可能
バックアップ
自動バックアップ: 設定した起動回数ごとに自動実行（デフォルト: 5回）
手動バックアップ: 設定タブの「今すぐバックアップ」ボタンをクリック
バックアップ場所: data/backups/
データベース
SQLiteを使用。初回起動時に自動的に作成されます。

テーブル構成
students - 生徒情報
student_id: TEXT PRIMARY KEY（年度-組番号、例: 2024-F1221）
student_number: TEXT（学籍番号、7桁）
courses - 講座情報
course_id: TEXT PRIMARY KEY（年度-講座番号、例: 2024-MATH-01）
correction_requests - 訂正依頼
operation_logs - 操作ログ（削除データの詳細記録）
system_settings - システム設定
app_title: アプリタイトル
notice_message: お知らせ内容
backup_interval: バックアップ間隔
launch_count: 起動回数カウンター
更新履歴
v1.5.0 (2024-10-18)
💾 バックアップ機能

✅ 定期自動バックアップ（起動回数ベース）
✅ バックアップ間隔設定変更
✅ 手動バックアップ機能
✅ 古いバックアップ自動削除（最新10件保持）
🔍 検索機能強化

✅ 生徒名ひらがな検索対応
✅ 講座名検索対応
🗄️ データベース構造改善

✅ 生徒ID: 年度-組番号（UNIQUE）
✅ 講座ID: 年度-講座番号（UNIQUE）
✅ 学籍番号: 7桁の数字
✅ CSVインポート時のID自動生成
🎨 UI改善

✅ 起動時に画面最大化
✅ 確認ダイアログに生徒名・講座名表示
✅ 日時・学期の表示改善
📊 操作ログ改善

✅ 削除時に詳細データを記録（復元用）
v1.4.0 (2024-10-18)
❌ 訂正依頼の「状態」フィールド削除
✅ ロック有無フィルター追加
✅ 「編集」→「表示」ボタンに名称変更
✅ 表示ウィンドウでロック済みも表示可能
✅ 編集時にロック済みは編集不可
✅ 訂正入力のCSVエクスポート機能
✅ お知らせタブ追加
✅ システム部管理に設定タブ追加
v1.3.0 (2024-10-18)
✨ 訂正依頼の編集機能を実装
✨ 生徒情報管理タブを追加
✨ 講座情報管理タブを追加
✨ 操作ログのCSVエクスポート機能追加
v1.2.0 (2024-10-18)
✨ 出欠訂正に学期フィールド追加
✨ 入力フォーム複製時に内容をそのまま複製
✨ 一般ユーザーによる編集・削除機能
v1.1.0 (2024-10-17)
✨ 組番号を5文字に拡張
✨ 出欠訂正に校時フィールド追加
v1.0.0 (2024-10-17)
🎉 初回リリース
ライセンス
このプロジェクトは教育目的で作成されています。

開発者
開発: seyaytua
